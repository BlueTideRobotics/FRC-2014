// Nicholas Currault, 11/8/13

#include "WPILib.h"
#include "Solenoid.h"

class RobotDemo : public SimpleRobot
{
	Joystick stick;
	DigitalInput pressureInCylinder;
	Relay pneumaRelay;
	
	Solenoid liftUp;
	Solenoid liftDown;
	Solenoid gripperOpen;
	Solenoid gripperClose;

public:
	RobotDemo(void):
		stick(1),
		
		liftUp(1),
		liftDown(3), 
		gripperOpen(6),
		gripperClose(8),
		
		pressureInCylinder(1),
		
		pneumaRelay(7)
	{
		// leave this here
	}

	void Autonomous(void)
	{
	}

	void OperatorControl(void)
	{
		/*
		 * Control Guide
		 * 
		 * Button 1: toggle relaySet
		 * Button 2: move lift down
		 * Button 3: move lift up
		 * Button 4: close gripper
		 * Button 5: open gripper
		 */
		
		bool onePressed=false;
		bool relaySet=false;
		
		// Initializing lift down
		liftUp.Set(false);
		liftDown.Set(true);
		
		//Initializing gripper open
		gripperOpen.Set(true);
		gripperClose.Set(false);
		
		while (IsOperatorControl())
		{
			// Update Smart Dashboard values
			SmartDashboard::PutBoolean("Compressor can be on?",relaySet);
			SmartDashboard::PutBoolean("Pressa",pressureInCylinder.Get());
			SmartDashboard::PutBoolean("Lift Up",liftUp.Get());
			SmartDashboard::PutBoolean("Lift Down",liftDown.Get());
			SmartDashboard::PutBoolean("Gripper Open",gripperOpen.Get());
			SmartDashboard::PutBoolean("Gripper Close",gripperClose.Get());
			
			// Adjust relaySet based on button 1
			if(stick.GetRawButton(1)&&!onePressed)
			{
				onePressed=true;
				relaySet=!relaySet;
			}
			else if(!stick.GetRawButton(1))
			{
				onePressed=false;
			}
			
			
			// Control relay using 'relaySet' and the pressure sensor.
			if (relaySet&&!pressureInCylinder.Get())
			{
				pneumaRelay.Set(Relay::kForward);
				SmartDashboard::PutBoolean("Compressor actually on?",true);
			}
			else
			{
				pneumaRelay.Set(Relay::kOff);
				SmartDashboard::PutBoolean("Compressor actually on?",false);
			}
			
			// Makes stuff move with solenoids
			// Gripper
			if(stick.GetRawButton(4)) // Close
			{
				gripperClose.Set(true);
				gripperOpen.Set(false);
			}
			else if(stick.GetRawButton(5)) // Open
			{
				gripperClose.Set(false);
				gripperOpen.Set(true);
			}
			
			// Lift
			if (stick.GetRawButton(2)) // Down
			{
				liftUp.Set(false);
				liftDown.Set(true);
			}
			else if (stick.GetRawButton(3)) // Up
			{
				liftUp.Set(true);
				liftDown.Set(false);
			}
		}
	}
	
	/**
	 * Runs during test mode
	 */
	void Test() {

	}
};

START_ROBOT_CLASS(RobotDemo);

